<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8"/>
    <title>Using MBrace with a Locally Simulated Cluster
</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <meta name="description" content="An open source framework for large-scale distributed computation and data processing written in F#."/>
    <meta name="author" content="Jan Dzik, Nick Palladinos, Kostas Rontogiannis, Eirik Tsarpalis"/>
    
    <script src="https://code.jquery.com/jquery-1.8.0.js"></script>
    <script src="https://code.jquery.com/ui/1.8.23/jquery-ui.js"></script>
    <script src="https://netdna.bootstrapcdn.com/twitter-bootstrap/2.2.1/js/bootstrap.min.js"></script>
    <link href="https://netdna.bootstrapcdn.com/twitter-bootstrap/2.2.1/css/bootstrap-combined.min.css" rel="stylesheet"/>

    <link rel="icon" type="image/png" href="http://www.mbrace.io/img/favicon-196x196.png" sizes="196x196"/>
    <link rel="icon" type="image/png" href="http://www.mbrace.io/img/favicon-160x160.png" sizes="160x160"/>
    <link rel="icon" type="image/png" href="http://www.mbrace.io/img/favicon-96x96.png" sizes="96x96"/>
    <link rel="icon" type="image/png" href="http://www.mbrace.io/img/favicon-16x16.png" sizes="16x16"/>
    <link rel="icon" type="image/png" href="http://www.mbrace.io/img/favicon-32x32.png" sizes="32x32"/>

    <link type="text/css" rel="stylesheet" href="http://www.mbrace.io/content/style.css" />
    <script type="text/javascript" src="http://www.mbrace.io/content/tips.js"></script>
    <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script src="https://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="container">
      <div class="masthead">
        <ul class="nav nav-pills pull-right">
          <li><a href="http://github.com/mbraceproject/MBrace.Core">github page</a></li>
        </ul>
        <h3 class="muted"><a href="http://www.mbrace.io/index.html">MBrace.Core and MBrace.Azure</a></h3>
      </div>
      <hr />
      <div class="row">
        <div class="span9" id="main">
          
<h1><a name="Using-MBrace-with-a-Locally-Simulated-Cluster" class="anchor" href="#Using-MBrace-with-a-Locally-Simulated-Cluster">Using MBrace with a Locally Simulated Cluster</a></h1>
<p>To use a locally simulated cluster,</p>
<ol>
<li><a href="https://github.com/mbraceproject/MBrace.StarterKit/blob/master/mbrace-versions.md">Download or clone the starter pack</a>.</li>
<li>Build the solution to get the required packages.</li>
<li>Open the first tutorial script and to use MBrace programming with your simulated cluster.</li>
</ol>
<p>The scripts follow the tutorials in the <a href="programming-model.html">Core Programming Model</a>.</p>
<p>The locally simulated cloud fabric is called "MBrace.Thespian".  This utilizes the multi-core capabillities of your
machine and is independent of any particular cloud provider, but supports the
same programming model as MBrace.Azure and other MBrace implementations.  This lets
you learn the MBrace cloud programming model in a provider-independent way.</p>
<h2><a name="Initializing-Thespian-Manually" class="anchor" href="#Initializing-Thespian-Manually">Initializing Thespian Manually</a></h2>
<p>Your cluster workers will be created automaticaly when using the scripts in the starter pack. You can also
initialize manually (e.g. from an application) as follows:</p>
<table class="pre"><tr><td class="lines"><pre class="fssnip"><span class="l">1: </span>
<span class="l">2: </span>
<span class="l">3: </span>
<span class="l">4: </span>
<span class="l">5: </span>
</pre></td>
<td class="snippet"><pre class="fssnip highlighted"><code lang="fsharp"><span class="k">open</span> <span onmouseout="hideTip(event, 'fs1', 1)" onmouseover="showTip(event, 'fs1', 1)" class="i">MBrace</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs2', 2)" onmouseover="showTip(event, 'fs2', 2)" class="i">Thespian</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs3', 3)" onmouseover="showTip(event, 'fs3', 3)" class="i">cluster</span> <span class="o">=</span> 
    <span onmouseout="hideTip(event, 'fs4', 4)" onmouseover="showTip(event, 'fs4', 4)" class="t">ThespianCluster</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs5', 5)" onmouseover="showTip(event, 'fs5', 5)" class="f">InitOnCurrentMachine</span>(<span class="i">workerCount</span> <span class="o">=</span> <span class="n">4</span>, 
                                         <span class="i">logger</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs6', 6)" onmouseover="showTip(event, 'fs6', 6)" class="t">ConsoleLogger</span>(), 
                                         <span class="i">logLevel</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs7', 7)" onmouseover="showTip(event, 'fs7', 7)" class="t">LogLevel</span><span class="o">.</span><span onmouseout="hideTip(event, 'fs8', 8)" onmouseover="showTip(event, 'fs8', 8)" class="i">Info</span>)
</code></pre></td>
</tr>
</table>
<p>You can create a multi-machine cluster using instances of <code>ThespianWorker</code> and <code>InitOnWorker</code>. This
is not covered in this tutorial.</p>

<div class="tip" id="fs1">namespace MBrace</div>
<div class="tip" id="fs2">namespace MBrace.Thespian</div>
<div class="tip" id="fs3">val cluster : ThespianCluster<br /><br />Full name: Thespian-tutorial.cluster</div>
<div class="tip" id="fs4">type ThespianCluster =<br />&#160;&#160;inherit MBraceClient<br />&#160;&#160;private new : state:ClusterState * logLevel:LogLevel option * defaultFaultPolicy:FaultPolicy option -&gt; ThespianCluster<br />&#160;&#160;private new : state:ClusterState * manager:IRuntimeManager * defaultFaultPolicy:FaultPolicy option -&gt; ThespianCluster<br />&#160;&#160;member AttachNewLocalWorkers : workerCount:int * ?logLevel:LogLevel * ?quiet:bool -&gt; unit<br />&#160;&#160;member AttachWorker : worker:ThespianWorker -&gt; unit<br />&#160;&#160;member DetachWorker : worker:IWorkerRef -&gt; unit<br />&#160;&#160;member KillAllWorkers : unit -&gt; unit<br />&#160;&#160;member KillWorker : worker:IWorkerRef -&gt; unit<br />&#160;&#160;member IsWorkerHosted : bool<br />&#160;&#160;member MasterNode : ThespianWorker option<br />&#160;&#160;...<br /><br />Full name: MBrace.Thespian.ThespianCluster</div>
<div class="tip" id="fs5">static member ThespianCluster.InitOnCurrentMachine : workerCount:int * ?hostClusterStateOnCurrentProcess:bool * ?fileStore:MBrace.Core.Internals.ICloudFileStore * ?faultPolicy:MBrace.Core.FaultPolicy * ?resources:MBrace.Core.Internals.ResourceRegistry * ?quiet:bool * ?logger:MBrace.Runtime.ISystemLogger * ?logLevel:LogLevel -&gt; ThespianCluster</div>
<div class="tip" id="fs6">type ConsoleLogger = MBrace.Runtime.ConsoleLogger<br /><br />Full name: MBrace.Thespian.ConsoleLogger</div>
<div class="tip" id="fs7">type LogLevel = MBrace.Runtime.LogLevel<br /><br />Full name: MBrace.Thespian.LogLevel</div>
<div class="tip" id="fs8">MBrace.Runtime.LogLevel.Info: MBrace.Runtime.LogLevel = 4</div>

        </div>
        <div class="span3">
          <a href="http://www.mbrace.io/index.html">
            <img src="http://www.mbrace.io/img/mbrace.png" alt="F# Project" style="width:150px;margin:10px" />
          </a>
          <ul class="nav nav-list" id="menu" style="margin-top: 20px;">
            <li class="nav-header">MBrace.Core and MBrace.Azure</li>
            <li><a href="http://www.mbrace.io/index.html">Home page</a></li>
            <li class="divider"></li>
            <li><a href="http://www.nuget.org/packages/MBrace.Core">Get Library via NuGet</a></li>
            <li><a href="http://github.com/mbraceproject/MBrace.Core">Source Code on GitHub</a></li>
            <li><a href="http://github.com/mbraceproject/MBrace.Core/blob/master/LICENSE.md">License</a></li>
            <li><a href="http://github.com/mbraceproject/MBrace.Core/blob/master/RELEASE_NOTES.md">Release Notes</a></li>

            <li class="nav-header">Getting Started</li>
            <li><a href="http://www.mbrace.io/thespian-tutorial.html">Local cluster</a></li>
            <li><a href="http://www.mbrace.io/azure-tutorial.html">Azure cluster</a></li>
            <li class="divider"></li>
            <li><a target="_blank" href="http://www.mbrace.io/mbrace-plos.pdf">PLOS'13 Publication</a></li>

            <li class="nav-header">Documentation</li>
            <li><a href="http://www.mbrace.io/programming-model.html">Programming model</a></li>
            <li><a href="http://www.mbrace.io/reference/core/index.html">API Reference (MBrace.Core)</a></li>
            <li><a href="http://www.mbrace.io/reference/runtime/index.html">API Reference (MBrace.Runtime)</a></li>
            <li><a href="http://www.mbrace.io/reference/flow/index.html">API Reference (MBrace.Flow)</a></li>
            <li class="divider"></li>
            <li><a href="http://www.mbrace.io/reference/thespian/index.html">Reference (Local)</a></li>
            <li><a href="http://www.mbrace.io/reference/azure/index.html">Reference (Azure)</a></li>
              <li><a href="http://www.mbrace.io/reference/aws/index.html">Reference (AWS)</a></li>
          </ul>
        </div>
      </div>
    </div>
    <a href="http://github.com/mbraceproject/MBrace.Core"><img style="position: absolute; top: 0; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_gray_6d6d6d.png" alt="Fork me on GitHub"/></a>
  </body>
  </html>
